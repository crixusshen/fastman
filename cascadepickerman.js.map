{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*************************","webpack:///./src/component/cascadePicker.js"],"names":["getCascadeLayer","data","layer","i","length","ds","sub","j","dss","k","seletor","params","$this","$","raw","format","name","result","d","push","getCities","value","getDistricts","p","c","cascadeLayer","provinces","map","provincesValue","initCities","initCitiesValue","initDistricts","initDistrictsValue","currentProvince","currentCity","currentDistrict","t","defaults","cssClass","rotateEffect","onChange","picker","values","displayValues","newProvince","cols","newCity","clearTimeout","setTimeout","newCities","newCitiesValue","replaceValues","newDistricts","newDistrictsValue","updateValue","textAlign","each","extend","val","join","split"],"mappings":"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","file":"cascadepickerman.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"fastman\"] = factory();\n\telse\n\t\troot[\"fastman\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","/**\n * 级联选择器\n * Created by dfzq on 2018/5/30.\n */\nimport basicPicker from './picker'\n\n/**\n * 获取数据结构的级联层级\n * @param data 数据结构\n * @returns {number}\n */\nvar getCascadeLayer = function (data) {\n    var layer = 0\n    // 第一层\n    for (var i = 0; i < data.length; i++) {\n        if (layer === 0) {\n            layer = 1\n        }\n\n        var ds = data[i].sub\n        if (ds) {\n            // 第二层\n            for (var j = 0; j < ds.length; j++) {\n                if (layer === 1) {\n                    layer = 2\n                }\n\n                var dss = ds[j].sub\n                if (dss) {\n                    // 第三层\n                    for (var k = 0; k < dss.length; k++) {\n                        return 3\n                    }\n                }\n            }\n        }\n    }\n    return layer\n}\n\nexport default (seletor, params) => {\n    var $this = $(seletor)\n    // 检查选择器是否存在\n    if (!$this.length) {\n        return\n    }\n    // 如果没有数据则不进行组件渲染\n    if (!params.data) {\n        return\n    }\n\n    // 数据源\n    let raw = params.data\n\n    /**\n     * 数据块解析函数\n     * @param data  数据中的sub块\n     * @param name  待解析的数据字段名\n     * @returns {*}\n     */\n    var format = function(data, name) {\n        var result = [];\n        for(var i = 0; i<data.length; i++) {\n            var d = data[i];\n            result.push(d[name]);\n        }\n        if(result.length) return result;\n        return [\"\"];\n    };\n\n    /**\n     * 获取数据中的sub数据块进行解析\n     * @param data  数据\n     * @param name  数据字段名\n     * @returns {[string]}\n     */\n    var sub = function(data, name) {\n        if(!data.sub) return [\"\"];\n        return format(data.sub, name);\n    };\n\n    /**\n     * 获取二级数据块\n     * @param d 一级数据\n     * @param name 数据字段名\n     * @returns {*}\n     */\n    var getCities = function(d, name) {\n        for(var i=0;i< raw.length;i++) {\n            if(raw[i].value === d) return sub(raw[i], name);\n        }\n        return [\"\"];\n    };\n\n    /**\n     * 获取三级数据块\n     * @param p 一级数据\n     * @param c 二级数据\n     * @param name 数据字段名\n     * @returns {*}\n     */\n    var getDistricts = function(p, c, name) {\n        for(var i = 0; i< raw.length; i++) {\n            if(raw[i].value === p) {\n                for(var j = 0; j< raw[i].sub.length; j++) {\n                    if(raw[i].sub[j].value === c) {\n                        return sub(raw[i].sub[j], name);\n                    }\n                }\n            }\n        }\n        return [\"\"];\n    };\n\n    // 检查数据源有几层（共3层，空数组为0层）\n    var cascadeLayer = getCascadeLayer(raw)\n    if (cascadeLayer === 0) {\n        return\n    }\n\n    // 一级元素显示名列表\n    var provinces = ['']\n    if (cascadeLayer > 0) {\n        provinces = raw.map(function(d) {\n            return d.name;\n        })\n    }\n\n    // 一级元素显示值列表\n    // 对value值进行追加，以保证防重名的处理\n    var provincesValue = ['']\n    if (cascadeLayer > 0) {\n        provincesValue = raw.map(function(d, i) {\n            return d.value;\n        });\n    }\n\n    // 初始化二级元素显示名列表\n    var initCities = ['']\n    if (cascadeLayer > 1) {\n        initCities = sub(raw[0], 'name');\n    }\n\n    // 初始化二级元素显示值列表\n    var initCitiesValue = ['']\n    if (cascadeLayer > 1) {\n        initCitiesValue = sub(raw[0], 'value');\n    }\n\n    // 初始化三级元素显示名列表\n    var initDistricts = [\"\"]\n    // 初始化三级元素显示值列表\n    var initDistrictsValue = [\"\"]\n    if (cascadeLayer > 2) {\n        if (!raw[0].sub) {\n            initDistricts = [\"\"];\n            initDistrictsValue = [\"\"];\n        } else {\n            initDistricts = sub(raw[0].sub[0], 'name');\n            initDistrictsValue = sub(raw[0].sub[0], 'value');\n        }\n    }\n\n    var currentProvince = provincesValue[0];\n    var currentCity = initCitiesValue[0];\n    var currentDistrict = initDistrictsValue[0];\n\n    // 默认配置\n    var t;\n    var defaults = {\n\n        cssClass: \"city-picker\",\n        rotateEffect: false,  //为了性能\n\n        onChange: function (picker, values, displayValues) {\n            var newProvince = picker.cols[0].value;\n            var newCity;\n            if(newProvince !== currentProvince) {\n                // 如果Province变化，节流以提高reRender性能\n                clearTimeout(t);\n\n                t = setTimeout(function(){\n                    if (cascadeLayer > 1) {\n                        var newCities = getCities(newProvince, 'name');\n                        var newCitiesValue = getCities(newProvince, 'value');\n                        newCity = newCitiesValue[0];\n                        picker.cols[1].replaceValues(newCitiesValue, newCities);\n                        currentCity = newCity;\n                    }\n\n                    if (cascadeLayer > 2) {\n                        var newDistricts = getDistricts(newProvince, newCity, 'name');\n                        var newDistrictsValue = getDistricts(newProvince, newCity, 'value');\n                        picker.cols[2].replaceValues(newDistrictsValue, newDistricts);\n                    }\n                    currentProvince = newProvince;\n                    picker.updateValue();\n                }, 200);\n                return;\n            }\n\n            if (cascadeLayer === 3) {\n                newCity = picker.cols[1].value;\n                if(newCity !== currentCity) {\n                    picker.cols[2].replaceValues(getDistricts(newProvince, newCity, 'value'), getDistricts(newProvince, newCity, 'name'));\n                    currentCity = newCity;\n                    picker.updateValue();\n                }\n            }\n\n        },\n\n        cols: []\n    };\n    if (cascadeLayer === 1) {\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: provinces,\n            values: provincesValue,\n            cssClass: \"col-province\"\n        })\n    }\n    else if (cascadeLayer === 2) {\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: provinces,\n            values: provincesValue,\n            cssClass: \"col-province\"\n        })\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: initCities,\n            values: initCitiesValue,\n            cssClass: \"col-city\"\n        })\n    }\n    else if (cascadeLayer === 3) {\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: provinces,\n            values: provincesValue,\n            cssClass: \"col-province\"\n        })\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: initCities,\n            values: initCitiesValue,\n            cssClass: \"col-city\"\n        })\n        defaults.cols.push({\n            textAlign: 'center',\n            displayValues: initDistricts,\n            values: initDistrictsValue,\n            cssClass: \"col-district\"\n        })\n    }\n\n\n    return $this.each(function() {\n        // 继承默认配置参数\n        var p = $.extend(defaults, params);\n\n        //计算value\n        if (p.value) {\n            $(this).val(p.value.join(' '));\n        } else {\n            var val = $(this).val();\n            val && (p.value = val.split(' '));\n        }\n\n        if (p.value) {\n            //p.value = val.split(\" \");\n            if(p.value[0]) {\n                currentProvince = p.value[0];\n                p.cols[1].values = getCities(p.value[0]);\n            }\n            if(p.value[1]) {\n                currentCity = p.value[1];\n                p.cols[2].values = getDistricts(p.value[0], p.value[1]);\n            } else {\n                p.cols[2].values = getDistricts(p.value[0], p.cols[1].values[0]);\n            }\n            !p.value[2] && (p.value[2] = '');\n            currentDistrict = p.value[2];\n        }\n        basicPicker(seletor, p);\n    });\n};\n\n\n// WEBPACK FOOTER //\n// ./src/component/cascadePicker.js"],"sourceRoot":""}