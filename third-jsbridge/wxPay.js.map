{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*******","webpack:///webpack/bootstrap 777558ddeb735e95237b?0c98*******","webpack:///./src/jsBridge/third-jsbridge/wxPay.js"],"names":["$","DATAKEY","setCurrentEnv","requestNo","date","Date","y","getFullYear","m","getMonth","d","getDate","h","getHours","min","getMinutes","s","getSeconds","ss","getMilliseconds","r","parseInt","Math","random","result","setNavigateBar","fastman","onNavigateBar","title","rightButtonTitle","onRightButtonPress","changeEnv","isShowBackButton","env","window","selectedVal","text","queryProductList","actionSheet","actions","value","onClick","v","bindPayEvent","cache","loadingToast","showStatus","http","scene","funcNo","params","productNo","specId","quantity","paymentType","protTypeCode","needSignFlag","productName","success","data","textStatus","jqXHR","checkLoginState","payload","code","wxPay","appId","wechatPayWay","partnerId","prePayId","noncestr","timestamp","package","sign","dialog","info","error","XMLHttpRequest","errorThrown","empty","append","specList","map","item","i","productHTML","salePrice","specName","document","off","on","find","end","ready","onViewWillAppear","oauth"],"mappings":"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","file":"wxPay.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"fastman\"] = factory();\n\telse\n\t\troot[\"fastman\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 777558ddeb735e95237b","/**\n * Created by dfzq on 2018/2/13.\n */\n$(function () {\n\n    // dom-cache key\n    var DATAKEY = 'prodData'\n    // 当前环境，默认dev\n    setCurrentEnv('dev')\n\n    // 生成请求流水号\n    function requestNo() {\n        var date = new Date()\n        var y = date.getFullYear(),\n            m = (date.getMonth() + 1) < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1,\n            d = date.getDate() < 10 ? '0' + date.getDate() : date.getDate(),\n            h = date.getHours() < 10 ? '0' + date.getHours() : date.getHours(),\n            min = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes(),\n            s = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds(),\n            ss = date.getMilliseconds() < 100 ? '0' + (date.getMilliseconds() < 10 ? '00' + date.getMilliseconds() : date.getMilliseconds()) : date.getMilliseconds(),\n            r = parseInt(Math.random() * 1000)\n        r = r < 100 ? r < 10 ? '00' + r : '0' + r : r\n        var result = y + m + d + h + min + s + ss + r\n        return result\n    }\n\n    // 设置导航\n    function setNavigateBar() {\n        if (fastman) {\n            fastman.onNavigateBar({\n                title: '微信支付',  // 导航标题\n                rightButtonTitle: '切换环境',   // 右侧按钮文字\n                onRightButtonPress: changeEnv, // 右侧按钮点击事件，不定义则不会触发点击\n                isShowBackButton: true, // 是否显示后退按钮，默认true(即显示)\n            })\n        }\n    }\n\n    // 设置环境\n    function setCurrentEnv(env) {\n        window.selectedVal = env\n        $('#currentEnv').text(env)\n        // 切换了环境需要重新刷新当前环境下的商品列表\n        queryProductList()\n    }\n\n    // 改变环境\n    function changeEnv() {\n        $.actionSheet({\n            actions: [\n                {\n                    text: \"sit\",\n                    value: \"sit\",\n                    onClick: function (v) {\n                        setCurrentEnv(v)\n                    },\n                },\n                {\n                    text: \"dev\",\n                    value: \"dev\",\n                    onClick: function (v) {\n                        setCurrentEnv(v)\n                    },\n                },\n            ],\n        });\n    }\n\n    // 支付绑定事件\n    function bindPayEvent(cache) {\n        $.loadingToast({\n            showStatus: 'show',\n            text: '支付请求中',\n        })\n        $.http({\n            scene: window.selectedVal,\n            funcNo: 'IF096103',\n            params: {\n                requestNo: requestNo(),\n                productNo: cache.productNo,\n                specId: cache.specId,\n                quantity: 1,\n                paymentType: 2,\n                protTypeCode: cache.protTypeCode,\n                needSignFlag: true,\n                productName: cache.productName\n            },\n            success: function (data, textStatus, jqXHR) {\n                if ($.checkLoginState(data.payload.code)) {\n                    $.loadingToast({\n                        showStatus: 'hide',\n                    })\n\n                    if (data.payload.code == 0) {\n                        // 发送微信支付指令通知\n                        wxPay({\n                            appId: data.payload.data.wechatPayWay.appId,\n                            partnerId: data.payload.data.wechatPayWay.partnerId,\n                            prePayId: data.payload.data.wechatPayWay.prePayId,\n                            noncestr: data.payload.data.wechatPayWay.noncestr,\n                            timestamp: data.payload.data.wechatPayWay.timestamp,\n                            package: data.payload.data.wechatPayWay.package,\n                            sign: data.payload.data.wechatPayWay.sign,\n                        })\n                    } else {\n                        $.dialog({\n                            text: data.payload.info,\n                        })\n                    }\n\n                } else {\n                    $.loadingToast({\n                        showStatus: 'hide',\n                    })\n                }\n            },\n            error: function (XMLHttpRequest, textStatus, errorThrown) {\n                $.dialog({\n                    text: '支付商品时出现错误',\n                })\n\n                $.loadingToast({\n                    showStatus: 'hide',\n                })\n            },\n        })\n    }\n\n    // 支付测试商品列表查询\n    function queryProductList() {\n        $.http({\n            scene: window.selectedVal,\n            funcNo: 'IF096102',\n            success: function (data, textStatus, jqXHR) {\n                $('#productListPanel').empty().append(data.payload.data.specList.map(function (item, i) {\n                    var productHTML = '<div class=\"weui-form-preview\">\\n' +\n                        '                <div class=\"weui-form-preview__hd\">\\n' +\n                        '                    <div class=\"weui-form-preview__item\">\\n' +\n                        '                        <label class=\"weui-form-preview__label\">付款金额</label>\\n' +\n                        '                        <em class=\"weui-form-preview__value\">¥' + item.salePrice + '</em>\\n' +\n                        '                    </div>\\n' +\n                        '                </div>\\n' +\n                        '                <div class=\"weui-form-preview__bd\">\\n' +\n                        '                    <div class=\"weui-form-preview__item\">\\n' +\n                        '                        <label class=\"weui-form-preview__label\">商品</label>\\n' +\n                        '                        <span class=\"weui-form-preview__value\">微信测试支付商品</span>\\n' +\n                        '                    </div>\\n' +\n                        '                </div>\\n' +\n                        '                <div class=\"weui-form-preview__bd\">\\n' +\n                        '                    <div class=\"weui-form-preview__item\">\\n' +\n                        '                        <label class=\"weui-form-preview__label\">规格参数</label>\\n' +\n                        '                        <span class=\"weui-form-preview__value\">' + item.specName + '</span>\\n' +\n                        '                    </div>\\n' +\n                        '                </div>\\n' +\n                        '                <div class=\"weui-form-preview__ft\">\\n' +\n                        '                    <a class=\"weui-form-preview__btn weui-form-preview__btn_warn wxpay'+ item.specId +'\" href=\"javascript:\">立即支付</a>\\n' +\n                        '                </div>\\n' +\n                        '            </div>'\n\n                    // 绑定支付按钮操作\n                    $(document).off('click', '.wxpay' + item.specId)\n                    $(document).on('click', '.wxpay' + item.specId,function(){\n                        bindPayEvent($(this).data(DATAKEY))\n                    })\n\n                    return $(productHTML).find('.wxpay' + item.specId).data(DATAKEY, {\n                        productNo: data.payload.data.productNo,\n                        specId: item.specId,\n                        protTypeCode: data.payload.data.protTypeCode,\n                        productName: data.payload.data.productName,\n                    }).end()\n                }))\n            },\n            error: function (XMLHttpRequest, textStatus, errorThrown) {\n                $.dialog({\n                    text: '查询商品时出现错误',\n                })\n            },\n        })\n    }\n    \n    fastman.ready(function () {\n        // 设置导航\n        setNavigateBar()\n\n        // 每次页面出现时重新刷新商品列表\n        fastman.onViewWillAppear(function () {\n            queryProductList()\n        })\n\n        // 建立oauth，一旦首次建立成功后会执行一次onViewWillAppear指令，随后便是通过客户端自身的生命周期函数来触发onViewWillAppear指令\n        $.oauth()\n    })\n})\n\n\n// WEBPACK FOOTER //\n// ./src/jsBridge/third-jsbridge/wxPay.js"],"sourceRoot":""}